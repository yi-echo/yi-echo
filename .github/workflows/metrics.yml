name: Generate GitHub Metrics (Terminal Modern)

on:
  schedule:
    - cron: "0 0 * * *" # 每天凌晨自动更新
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: 📊 Generate terminal-style metrics (modern + fast)
        uses: lowlighter/metrics@latest
        with:
          # 🔑 GitHub Token (请使用 Personal Access Token)
          token: ${{ secrets.METRICS_TOKEN }}

          # 👤 用户信息
          user: yi-echo

          # ⚙️ 模板与渲染配置
          template: terminal-modern
          config_timezone: Asia/Shanghai
          config_padding: 0
          use_prebuilt_image: yes       # ✅ 使用预构建镜像，显著提速
          optimize: yes                 # ✅ 优化 SVG 体积
          clean_workflows: yes          # ✅ 自动清理旧工作流缓存

          # 📈 核心展示模块
          base: header, repositories, metadata

          # 💻 语言统计
          plugin_languages: yes
          plugin_languages_limit: 8
          plugin_languages_ignored: html, css
          plugin_languages_threshold: 0%
          plugin_languages_sections: most-used

          # 📂 输出文件
          filename: github-metrics.svg
